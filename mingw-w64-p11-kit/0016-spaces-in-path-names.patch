--- p11-kit-0.24.1/build/m4/libtool.m4	2022-01-17 06:46:32.000000000 -0800
+++ p11-kit-0.24.1/build/m4/libtool.m4.new	2022-08-01 22:20:53.192050300 -0700
@@ -3261,9 +3261,9 @@
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return, which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog="`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'`" ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog="`($CC -print-prog-name=ld) 2>&5`" ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -3272,9 +3272,9 @@
       # Canonicalize the pathname of ld
       ac_prog=`$ECHO "$ac_prog"| $SED 's%\\\\%/%g'`
       while $ECHO "$ac_prog" | $GREP "$re_direlt" > /dev/null 2>&1; do
-	ac_prog=`$ECHO $ac_prog| $SED "s%$re_direlt%/%"`
+        ac_prog=`$ECHO "$ac_prog" | $SED "s%$re_direlt%/%"`
       done
-      test -z "$LD" && LD=$ac_prog
+      test -z "$LD" && LD="$ac_prog"
       ;;
   "")
     # If it fails, then pretend we aren't using GCC.
@@ -3297,7 +3297,7 @@
     IFS=$lt_save_ifs
     test -z "$ac_dir" && ac_dir=.
     if test -f "$ac_dir/$ac_prog" || test -f "$ac_dir/$ac_prog$ac_exeext"; then
-      lt_cv_path_LD=$ac_dir/$ac_prog
+      lt_cv_path_LD="$ac_dir/$ac_prog"
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
--- p11-kit-0.24.1/build/litter/ltmain.sh	2022-01-17 06:46:32.000000000 -0800
+++ p11-kit-0.24.1/build/litter/ltmain.sh.new	2022-08-01 22:20:53.223049400 -0700
@@ -3893,7 +3893,7 @@
       esac
 
       # Get the absolute pathname.
-      absdir=`cd "$dir" && pwd`
+      absdir="`cd "$dir" && pwd`"
       test -n "$absdir" && dir=$absdir
 
       # Now add the directory to shlibpath_var.
@@ -6526,7 +6526,7 @@
     compiler_flags=
     linker_flags=
     dllsearchpath=
-    lib_search_path=`pwd`
+    lib_search_path=\"`pwd`\"
     inst_prefix_dir=
     new_inherited_linker_flags=
 
@@ -6987,7 +6987,7 @@
 	    [\\/]* | [A-Za-z]:[\\/]* | =*) func_append deplibs " $arg" ;;
 	    *) func_append deplibs " -L$dir" ;;
 	  esac
-	  func_append lib_search_path " $dir"
+	  func_append lib_search_path " \"$dir\""
 	  ;;
 	esac
 	case $host in
@@ -7457,9 +7457,13 @@
 
     if test -n "$shlibpath_var"; then
       # get the directories listed in $shlibpath_var
-      eval shlib_search_path=\`\$ECHO \"\$$shlibpath_var\" \| \$SED \'s/:/ /g\'\`
+      func_echo "7506: shlibpath_var = $shlibpath_var ..."
+      eval "shlibpath_var=\$$shlibpath_var"
+      func_echo "7508: shlibpath_var = $shlibpath_var ..."
+      IFS=':' shlib_search_path=($shlibpath_var)
+      func_echo "7513: $ECHO $(declare -p shlib_search_path) ..."
     else
-      shlib_search_path=
+      shlib_search_path=()
     fi
     eval sys_lib_search_path=\"$sys_lib_search_path_spec\"
     eval sys_lib_dlsearch_path=\"$sys_lib_dlsearch_path_spec\"
@@ -7637,7 +7641,7 @@
 	  for searchdir in $searchdirs; do
 	    for search_ext in .la $std_shrext .so .a; do
 	      # Search the libtool library
-	      lib=$searchdir/lib$name$search_ext
+	      lib="$searchdir/lib$name$search_ext"
 	      if test -f "$lib"; then
 		if test .la = "$search_ext"; then
 		  found=:
